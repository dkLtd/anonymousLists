function tabsHolder(e){var t=jQuery(e);return t.length===0?jQuery("<div id='"+e.replace("#","")+"' class='backgroundMode'></div>"):t}(function(e){function r(e,t,n){if(typeof e===n){var r=[];for(var i=0;i<t;i++){r[i]=e}return r}else{return e}}function s(t,n){var r=t.data("anonymousLists"),s="#"+t.attr("id"),u=r.lists,a=r.listCaptions;if(r.backgroundMode||u.length!=a.length)return;for(i in u){e(s+" a:[href='#"+r.id+"_"+u[i]+"Panel']").html(o(u[i],a[i],n))}w(r.id+"_lang",n,365)}function o(e,t,n){var r=t.split("|");for(var i=0;i<r.length;i++){if(r[i].indexOf(n+"-")!=-1){return r[i].replace(n+"-","")}}return e}function u(e,t){return"<li><a href='#"+e+"_"+t.replace(" ","")+"Panel'>"+t+"</a></li>"}function a(e,n,r){var i=e.data("anonymousLists"),s=i.id+"_"+n,o="<div id='"+s.replace(" ","")+"Panel' class='panel'>",u=E(s),a=[],f=[],l;if(u!=null){a=u.split(t.item)}if(a.length>0){o+="<ul>";for(var c=a.length-1;c>=0;c--){f=a[c].split(t.data);l={title:f[0],url:f[1],info:f[2]};o+="<li>"+i.onRenderItem.call(e,l)+(i.deleteItemButton?"<a id='btnDel"+n+"' class='delItem' title='Remove from list'>"+"Remove</a>":"")+"</li>"}o+="</ul>"+(i.clearListButton?"<button id='btnClear"+n+"' class='clearList'>Clear "+n+"</button>":"")}else{o+=r}return o+"</div>"}function f(e){return"<a href='"+e.url+" class='item'>"+e.title+"</a>"+(e.info===""?"":"<br><em>"+c(e.info)+"</em>")}function l(e){return"<a href='"+e.url+"'"+(e.info===""?"":" title='"+c(e.info)+"'")+" class='item'>"+e.title+"</a>"}function c(e){if(Date.parse(e)){var t=new Date(e);if(h(t)){return"Last visited today on "+p(t)}else{return"Last visited on "+v(t)}}else{return e}}function h(e){return(new Date(e)).setHours(0,0,0,0)===(new Date).setHours(0,0,0,0)}function p(e){return(e.getHours()>12?e.getHours()-12:e.getHours())+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()+(e.getHours()>12?" PM":" AM")}function d(e){return(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)+"/"+e.getFullYear()}function v(e){return d(e)+" "+p(e)}function m(n,r,i,s,o,u){var f=n.data("anonymousLists"),l=f.id+"_"+r,c=E(l),h=[],p=f.listSizes[f.lists.indexOf(r)];if(c!=null){h=c.split(t.item)}for(var d in h){if(h[d].split(t.data)[1]===s){h.splice(d,1);break}}h.push(g(i)+t.data+s+t.data+g(o));w(l,h.slice(h.length>p?1:0).join(t.item),365);if(u&&!f.backgroundMode){var v="#"+l.replace(" ","")+"Panel",m=e(v),y=m.is(":visible");m.replaceWith(a(n,r,""));if(!y){e(v).attr("style","display: none !important")}if(f.autoTabSwitch&&!y&&r!="History"){e(v).parent().parent().find(".tabs li a:contains('"+r+"')").click()}}}function g(e){return typeof e==="string"?e.replace(t.item,"").replace(t.data,""):e}function y(n,r,i){var s=n.data("anonymousLists"),o=s.id+"_"+r,u=E(o),f=[],l=[],c="",h=-1;if(u!=null){f=u.split(t.item)}if(typeof i!="number"){for(var p in f){l=f[p].split(t.data);if(l[1]===i){c=i;h=p;break}}}else{h=f.length-i-1;c=f[h].split(t.data)[1]}if(h!=-1){if(f.length>1){f.splice(h,1);w(o,f.join(t.item),365)}else{S(o)}if(!s.backgroundMode){var d="#"+o.replace(" ","")+"Panel",v=e(d),m=v.is(":visible");v.replaceWith(a(n,r,s.emptyListsHTML[s.lists.indexOf(r)]));if(!m){e(d).attr("style","display: none !important")}if(s.autoTabSwitch&&!m&&r!="History"){e(d).parent().parent().find(".tabs li a:contains('"+r+"')").click()}}}return{url:c,index:h}}function b(e,n,r){var i=e.data("anonymousLists").id+"_"+n,s=E(i),o=[],u=[];if(s!=null){o=s.split(t.item)}for(var a in o){u=o[a].split(t.data);if(u[1]===r){return a}}return-1}function w(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i}function E(e){var t=document.cookie,n=t.indexOf(" "+e+"=");if(n===-1){n=t.indexOf(e+"=")}if(n===-1){t=null}else{n=t.indexOf("=",n)+1;var r=t.indexOf(";",n);if(r===-1){r=t.length}t=unescape(t.substring(n,r))}return t}function S(e){w(e,"",-1)}var t={item:"__",data:"--"};e.fn.anonymousLists=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.anonymousLists")}};e.fn.anonymousLists.defaultSettings={id:"anonLists",lists:["History"],listCaptions:[],lang:"",listSizes:20,preserveTab:false,autoHistory:true,clearListButton:false,deleteItemButton:true,backgroundMode:false,autoTabSwitch:false,emptyListsHTML:"<div class='emptyText'></div>",onClearList:function(){},onDeleteItem:function(){},onRenderItem:function(e){return l(e)}};var n={init:function(t){return this.each(function(){var n=e(this);n.settings=e.extend(true,{},e.fn.anonymousLists.defaultSettings,t||{});n.settings.id+="-"+n.attr("id");if(n.hasClass("backgroundMode")){n.settings.backgroundMode=true}var o=n.settings.lists,f=n.settings.id,l=[],c="",h="",p=null,d=null;n.settings.listSizes=r(n.settings.listSizes,o.length,"number");l=n.settings.emptyListsHTML=r(n.settings.emptyListsHTML,o.length,"string");n.data("anonymousLists",n.settings);for(i in o){if(o[i]==="History"&&n.settings.autoHistory){m(n,"History",document.title,location.href,new Date,false)}if(!n.settings.backgroundMode){c+=u(f,o[i]);h+=a(n,o[i],l[i])}}if(n.settings.backgroundMode){return}n.addClass("cleanslate");n.append("<div class='myLists'><ul class='tabs'>"+c+"</ul><div class='panelContainer'>"+h+"</div></div>");d=E(f+"_lang");d=d==null?n.settings.lang:d;if(d!=""){s(n,d)}n.children().find(".tabs a").click(function(){var t=e(this);n.find(".panel").attr("style","display: none !important").end().find(".tabs a.active").removeClass("active").end().find(t.attr("href")).fadeIn(250);t.addClass("active").blur();if(n.settings.preserveTab){w(f+"_tab",t.attr("href"),365)}return false});n.delegate(".clearList","click",function(){var t=e(this),r=t.attr("id").replace("btnClear","");S(f+"_"+r);t.parent().replaceWith(a(n,r,l[o.indexOf(r)]));n.settings.onClearList.call(n);return false});n.delegate(".delItem","click",function(){var t=e(this),r=t.attr("id").replace("btnDel","");n.settings.onDeleteItem.call(n,y(n,r,t.parent().index()));return false});if(n.settings.preserveTab){p=E(f+"_tab")}n.find(".tabs li"+(p==null?":first a":" a:[href='"+p+"']")).click()})},addToHistory:function(){m(e(this),"History",document.title,location.href,new Date,true)},addToList:function(t,n,r,i){m(e(this),t,n,r,i==null?"":i,true)},addItemToList:function(t,n){m(e(this),t,n.title,n.url,n.info==null?"":n.info,true)},remFromList:function(t,n){return y(e(this),t,n)},isInList:function(t,n){return b(e(this),t,n)>-1?true:false},setLang:function(t){s(e(this),t)}}})(jQuery)