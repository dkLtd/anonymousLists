function tabsHolder(e){var t=jQuery(e);return t.length===0?jQuery("<div id='"+e.replace("#","")+"' class='backgroundMode'></div>"):t}(function(e){function r(e,t,n){if(typeof e===n){var r=[];for(var i=0;i<t;i++){r[i]=e}return r}else{return e}}function s(e,t){return"<li><a href='#"+e+"_"+t.replace(" ","")+"Panel'>"+t+"</a></li>"}function o(e,n,r){var i=e.data("anonymousLists"),s=i.id+"_"+n,o="<div id='"+s.replace(" ","")+"Panel' class='panel'>",u=b(s),a=[],f=[],l;if(u!=null){a=u.split(t.item)}if(a.length>0){o+="<ul>";for(var c=a.length-1;c>=0;c--){f=a[c].split(t.data);l={title:f[0],url:f[1],info:f[2]};o+="<li>"+i.onRenderItem.call(e,l)+(i.deleteItemButton?"<a id='btnDel"+n+"' class='delItem' title='Remove from list'>"+"Remove</a>":"")+"</li>"}o+="</ul>"+(i.clearListButton?"<button id='btnClear"+n+"' class='clearList'>Clear "+n+"</button>":"")}else{o+=r}return o+"</div>"}function u(e){return"<a href='"+e.url+" class='item'>"+e.title+"</a>"+(e.info===""?"":"<br><em>"+f(e.info)+"</em>")}function a(e){return"<a href='"+e.url+"'"+(e.info===""?"":" title='"+f(e.info)+"'")+" class='item'>"+e.title+"</a>"}function f(e){if(Date.parse(e)){var t=new Date(e);if(l(t)){return"Last visited today on "+c(t)}else{return"Last visited on "+p(t)}}else{return e}}function l(e){return(new Date(e)).setHours(0,0,0,0)===(new Date).setHours(0,0,0,0)}function c(e){return(e.getHours()>12?e.getHours()-12:e.getHours())+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()+(e.getHours()>12?" PM":" AM")}function h(e){return(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)+"/"+e.getFullYear()}function p(e){return h(e)+" "+c(e)}function d(n,r,i,s,u,a){var f=n.data("anonymousLists"),l=f.id+"_"+r,c=b(l),h=[],p=f.listSizes[f.lists.indexOf(r)];if(c!=null){h=c.split(t.item)}for(var d in h){if(h[d].split(t.data)[1]===s){h.splice(d,1);break}}h.push(v(i)+t.data+s+t.data+v(u));y(l,h.slice(h.length>p?1:0).join(t.item),365);if(a&&!f.backgroundMode){var m="#"+l.replace(" ","")+"Panel",g=e(m),w=g.is(":visible");g.replaceWith(o(n,r,""));if(!w){e(m).attr("style","display: none !important")}if(f.autoTabSwitch&&!w&&r!="History"){e(m).parent().parent().find(".tabs li a:contains('"+r+"')").click()}}}function v(e){return typeof e==="string"?e.replace(t.item,"").replace(t.data,""):e}function m(n,r,i){var s=n.data("anonymousLists"),u=s.id+"_"+r,a=b(u),f=[],l=[],c="",h=-1;if(a!=null){f=a.split(t.item)}if(typeof i!="number"){for(var p in f){l=f[p].split(t.data);if(l[1]===i){c=i;h=p;break}}}else{h=f.length-i-1;c=f[h].split(t.data)[1]}if(h!=-1){if(f.length>1){f.splice(h,1);y(u,f.join(t.item),365)}else{w(u)}if(!s.backgroundMode){var d="#"+u.replace(" ","")+"Panel",v=e(d),m=v.is(":visible");v.replaceWith(o(n,r,s.emptyListsHTML[s.lists.indexOf(r)]));if(!m){e(d).attr("style","display: none !important")}if(s.autoTabSwitch&&!m&&r!="History"){e(d).parent().parent().find(".tabs li a:contains('"+r+"')").click()}}}return{url:c,index:h}}function g(e,n,r){var i=e.data("anonymousLists").id+"_"+n,s=b(i),o=[],u=[];if(s!=null){o=s.split(t.item)}for(var a in o){u=o[a].split(t.data);if(u[1]===r){return a}}return-1}function y(e,t,n){var r=new Date;r.setDate(r.getDate()+n);var i=escape(t)+(n==null?"":"; expires="+r.toUTCString());document.cookie=e+"="+i}function b(e){var t=document.cookie,n=t.indexOf(" "+e+"=");if(n===-1){n=t.indexOf(e+"=")}if(n===-1){t=null}else{n=t.indexOf("=",n)+1;var r=t.indexOf(";",n);if(r===-1){r=t.length}t=unescape(t.substring(n,r))}return t}function w(e){y(e,"",-1)}var t={item:"__",data:"--"};e.fn.anonymousLists=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.anonymousLists")}};e.fn.anonymousLists.defaultSettings={id:"anonLists",lists:["History"],listSizes:20,preserveTab:false,autoHistory:true,clearListButton:false,deleteItemButton:true,backgroundMode:false,autoTabSwitch:false,emptyListsHTML:"<div class='emptyText'></div>",onClearList:function(){},onDeleteItem:function(){},onRenderItem:function(e){return a(e)}};var n={init:function(t){return this.each(function(){var n=e(this);n.settings=e.extend(true,{},e.fn.anonymousLists.defaultSettings,t||{});n.settings.id+="-"+n.attr("id");if(n.hasClass("backgroundMode")){n.settings.backgroundMode=true}var u=n.settings.lists,a=n.settings.id,f=[],l="",c="",h=null;n.settings.listSizes=r(n.settings.listSizes,u.length,"number");f=n.settings.emptyListsHTML=r(n.settings.emptyListsHTML,u.length,"string");n.data("anonymousLists",n.settings);for(i in u){if(u[i]==="History"&&n.settings.autoHistory){d(n,"History",document.title,location.href,new Date,false)}if(!n.settings.backgroundMode){l+=s(a,u[i]);c+=o(n,u[i],f[i])}}if(n.settings.backgroundMode){return}n.addClass("cleanslate");n.append("<div class='myLists'><ul class='tabs'>"+l+"</ul><div class='panelContainer'>"+c+"</div></div>");n.children().find(".tabs a").click(function(){var t=e(this);n.find(".panel").attr("style","display: none !important").end().find(".tabs a.active").removeClass("active").end().find(t.attr("href")).fadeIn(250);t.addClass("active").blur();if(n.settings.preserveTab){y(a+"_tab",t.text(),365)}return false});n.delegate(".clearList","click",function(){var t=e(this),r=t.attr("id").replace("btnClear","");w(a+"_"+r);t.parent().replaceWith(o(n,r,f[u.indexOf(r)]));n.settings.onClearList.call(n);return false});n.delegate(".delItem","click",function(){var t=e(this),r=t.attr("id").replace("btnDel","");n.settings.onDeleteItem.call(n,m(n,r,t.parent().index()));return false});if(n.settings.preserveTab){h=b(a+"_tab")}n.find(".tabs li"+(h==null?":first a":" a:contains('"+h+"')")).click()})},addToHistory:function(){d(e(this),"History",document.title,location.href,new Date,true)},addToList:function(t,n,r,i){d(e(this),t,n,r,i==null?"":i,true)},addItemToList:function(t,n){d(e(this),t,n.title,n.url,n.info==null?"":n.info,true)},remFromList:function(t,n){return m(e(this),t,n)},isInList:function(t,n){return g(e(this),t,n)>-1?true:false}}})(jQuery)